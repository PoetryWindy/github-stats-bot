# GitHub ç»Ÿè®¡æœºå™¨äºº

åŸºäº GitHub Actions å’Œ Python çš„è‡ªåŠ¨åŒ– GitHub ç»Ÿè®¡æœºå™¨äººï¼Œæ”¯æŒæ¯æ—¥å’Œæ¯å‘¨æŠ¥å‘Šç”Ÿæˆï¼Œé€šè¿‡é‚®ä»¶å’Œ OneBot å‘é€é€šçŸ¥ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“Š **å¤šä»“åº“ç»Ÿè®¡**: æ”¯æŒç»Ÿè®¡å¤šä¸ª GitHub ä»“åº“çš„ä»£ç æäº¤å’Œ Issue æ´»åŠ¨
- â° **çµæ´»å‘¨æœŸ**: æ”¯æŒæ¯æ—¥æŠ¥å‘Šï¼ˆ24å°æ—¶ï¼‰å’Œæ¯å‘¨æŠ¥å‘Šï¼ˆ7å¤©ï¼‰
- ğŸ“§ **å¤šç§é€šçŸ¥**: æ”¯æŒé‚®ä»¶å’Œ OneBot æ¶ˆæ¯é€šçŸ¥
- ğŸ”’ **å®‰å…¨é…ç½®**: æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ï¼Œé…ç½®æ–‡ä»¶ä»…å­˜å‚¨éæ•æ„Ÿè®¾ç½®
- ğŸš€ **è‡ªåŠ¨åŒ–éƒ¨ç½²**: åŸºäº GitHub Actions å®ç°å®Œå…¨è‡ªåŠ¨åŒ–
- ğŸ›¡ï¸ **å®¹é”™æœºåˆ¶**: å®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œå•ä¸ªä»“åº“å¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹
- ğŸ“ˆ **è¯¦ç»†ç»Ÿè®¡**: æ’é™¤ Merge æäº¤ï¼Œæä¾›å‡€å¢ä»£ç è¡Œæ•°ç­‰å…³é”®æŒ‡æ ‡

## é¡¹ç›®ç»“æ„

```
github_bot/
â”œâ”€â”€ .github/workflows/          # GitHub Actions å·¥ä½œæµ
â”‚   â”œâ”€â”€ daily-stats.yml        # æ¯æ—¥æŠ¥å‘Šå·¥ä½œæµ
â”‚   â””â”€â”€ weekly-stats.yml       # æ¯å‘¨æŠ¥å‘Šå·¥ä½œæµ
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ settings.json          # æŠ¥å‘Šé…ç½®
â”‚   â””â”€â”€ repos.json             # ä»“åº“åˆ—è¡¨
â”œâ”€â”€ scripts/                    # Python è„šæœ¬
â”‚   â”œâ”€â”€ run_report.py          # ä¸»å…¥å£è„šæœ¬
â”‚   â”œâ”€â”€ stats_core.py          # ç»Ÿè®¡æ ¸å¿ƒæ¨¡å—
â”‚   â””â”€â”€ send_utils.py          # é€šçŸ¥å‘é€æ¨¡å—
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                 # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. Fork æˆ–å…‹éš†ä»“åº“

```bash
git clone [https://github.com/your-username/github_bot.git](https://github.com/PoetryWindy/github-stats-bot.git)
cd github_bot
```

### 2. é…ç½®ä»“åº“åˆ—è¡¨

ç¼–è¾‘ `config/repos.json` æ–‡ä»¶ï¼Œæ·»åŠ è¦ç»Ÿè®¡çš„ä»“åº“ï¼š

```json
[
  "microsoft/vscode",
  "facebook/react", 
  "nodejs/node",
  "your-org/your-repo"
]
```

### 3. é…ç½®æŠ¥å‘Šè®¾ç½®

ç¼–è¾‘ `config/settings.json` æ–‡ä»¶ï¼š

```json
{
  "daily_report": {
    "enabled": true,
    "days_back": 1,
    "include_issues": true
  },
  "weekly_report": {
    "enabled": true,
    "days_back": 7,
    "include_issues": true
  },
  "email_recipients": [
    "admin@example.com"
  ]
}
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ GitHub ä»“åº“çš„ Settings > Secrets and variables > Actions ä¸­æ·»åŠ ä»¥ä¸‹ Secretsï¼š

#### å¿…éœ€çš„ç¯å¢ƒå˜é‡
- `GITHUB_TOKEN`: GitHub API Tokenï¼ˆé€šå¸¸ç”± GitHub Actions è‡ªåŠ¨æä¾›ï¼‰

#### é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
- `EMAIL_USER`: å‘ä»¶äººé‚®ç®±
- `EMAIL_PASSWORD`: é‚®ç®±å¯†ç æˆ–åº”ç”¨ä¸“ç”¨å¯†ç 
- `EMAIL_RECIPIENT`: æ”¶ä»¶äººé‚®ç®±ï¼ˆä¼˜å…ˆçº§é«˜äºé…ç½®æ–‡ä»¶ï¼‰
- `SMTP_HOST`: SMTP æœåŠ¡å™¨åœ°å€
- `SMTP_PORT`: SMTP ç«¯å£
- `SMTP_USE_TLS`: æ˜¯å¦ä½¿ç”¨ TLSï¼ˆtrue/falseï¼‰

#### OneBot é…ç½®ï¼ˆå¯é€‰ï¼‰
- `ONEBOT_URL`: OneBot HTTP API åœ°å€
- `ONEBOT_QQ`: ç›®æ ‡ QQ å·

### 5. æœ¬åœ°æµ‹è¯•

1. å¤åˆ¶ `env.example` ä¸º `.env` å¹¶å¡«å…¥çœŸå®é…ç½®ï¼š
   ```bash
   cp env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥çœŸå®é…ç½®
   ```

2. å®‰è£…ä¾èµ–ï¼š
   ```bash
   pip install -r requirements.txt
   ```

3. è¿è¡Œæµ‹è¯•ï¼š
   ```bash
   # æµ‹è¯•æ¯æ—¥æŠ¥å‘Š
   python scripts/run_report.py daily
   
   # æµ‹è¯•æ¯å‘¨æŠ¥å‘Š  
   python scripts/run_report.py weekly
   ```

4. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯é…ç½®ï¼š
   ```bash
   python test_bot.py
   ```

5. æ£€æŸ¥è¾“å‡ºï¼Œç¡®ä¿ç»Ÿè®¡æ•°æ®å’Œé€šçŸ¥å‘é€æ­£å¸¸

## ç»Ÿè®¡å†…å®¹

### ä»£ç æäº¤ç»Ÿè®¡
- æ€»æäº¤æ¬¡æ•°ï¼ˆæ’é™¤ Merge æäº¤ï¼‰
- æ–°å¢ä»£ç è¡Œæ•°
- åˆ é™¤ä»£ç è¡Œæ•°
- å‡€å¢ä»£ç è¡Œæ•°

### Issue æ´»åŠ¨ç»Ÿè®¡
- æ–°å¢ Issue æ•°é‡
- å…³é—­ Issue æ•°é‡
- è¯„è®ºæ€»æ•°

## æŠ¥å‘Šæ ¼å¼

æŠ¥å‘Šé‡‡ç”¨çº¯æ–‡æœ¬æ ¼å¼ï¼ŒåŒ…å«ï¼š
- æ—¶é—´èŒƒå›´ä¿¡æ¯
- æ€»ä½“ç»Ÿè®¡æ•°æ®
- å„ä»“åº“è¯¦ç»†ç»Ÿè®¡
- ç”Ÿæˆæ—¶é—´æˆ³

ç¤ºä¾‹æŠ¥å‘Šï¼š
```
ğŸ“Š GitHub Daily ç»Ÿè®¡æŠ¥å‘Š
â° æ—¶é—´èŒƒå›´: 2024-01-15 00:00 UTC è‡³ 2024-01-16 00:00 UTC
ğŸ“ ç»Ÿè®¡ä»“åº“æ•°: 3

ğŸ“ˆ æ€»ä½“ç»Ÿè®¡:
  â€¢ ä»£ç æäº¤: 1,234 æ¬¡
  â€¢ æ–°å¢ä»£ç : 45,678 è¡Œ
  â€¢ åˆ é™¤ä»£ç : 12,345 è¡Œ
  â€¢ å‡€å¢ä»£ç : 33,333 è¡Œ
  â€¢ æ–°å¢ Issue: 56 ä¸ª
  â€¢ å…³é—­ Issue: 42 ä¸ª
  â€¢ è¯„è®ºæ€»æ•°: 234 æ¡

ğŸ“‹ å„ä»“åº“è¯¦æƒ…:
...
```

## å·¥ä½œæµè¯´æ˜

### æ¯æ—¥æŠ¥å‘Š
- è§¦å‘æ—¶é—´ï¼šæ¯å¤© UTC 0:00ï¼ˆåŒ—äº¬æ—¶é—´ 8:00ï¼‰
- ç»Ÿè®¡èŒƒå›´ï¼šè¿‡å» 24 å°æ—¶
- æ”¯æŒæ‰‹åŠ¨è§¦å‘

### æ¯å‘¨æŠ¥å‘Š
- è§¦å‘æ—¶é—´ï¼šæ¯å‘¨ä¸€ UTC 0:00ï¼ˆåŒ—äº¬æ—¶é—´ 8:00ï¼‰
- ç»Ÿè®¡èŒƒå›´ï¼šè¿‡å» 7 å¤©
- æ”¯æŒæ‰‹åŠ¨è§¦å‘

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **API é™æµ**: GitHub API æœ‰é€Ÿç‡é™åˆ¶ï¼Œå¦‚æœä»“åº“è¿‡å¤šå¯èƒ½è§¦å‘é™æµ
   - è§£å†³æ–¹æ¡ˆï¼šå‡å°‘ä»“åº“æ•°é‡æˆ–å¢åŠ è¯·æ±‚é—´éš”
   
2. **æƒé™ä¸è¶³**: ç¡®ä¿ GITHUB_TOKEN æœ‰è¶³å¤Ÿæƒé™è®¿é—®ç›®æ ‡ä»“åº“
   - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ token æƒé™ï¼Œç¡®ä¿æœ‰ `repo` æƒé™
   
3. **é‚®ä»¶å‘é€å¤±è´¥**: æ£€æŸ¥ SMTP é…ç½®å’Œé‚®ç®±è®¾ç½®
   - è§£å†³æ–¹æ¡ˆï¼šéªŒè¯ SMTP æœåŠ¡å™¨åœ°å€ã€ç«¯å£ã€ç”¨æˆ·åå¯†ç 
   - æ³¨æ„ï¼šGmail éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 
   
4. **OneBot è¿æ¥å¤±è´¥**: ç¡®è®¤ OneBot æœåŠ¡è¿è¡Œæ­£å¸¸ä¸” URL æ­£ç¡®
   - è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ OneBot æœåŠ¡çŠ¶æ€å’Œ API åœ°å€
   
5. **ä»“åº“ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®**: æ£€æŸ¥ä»“åº“åç§°æ ¼å¼å’Œè®¿é—®æƒé™
   - è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿ä»“åº“åç§°æ ¼å¼ä¸º `owner/repo`ï¼Œä¸” token æœ‰è®¿é—®æƒé™

### è°ƒè¯•æ¨¡å¼

ä½¿ç”¨ `workflow_dispatch` è§¦å‘å·¥ä½œæµæ—¶ï¼Œå¯ä»¥å¯ç”¨ dry run æ¨¡å¼ï¼Œåªç”ŸæˆæŠ¥å‘Šä¸ä¸Šä¼ ï¼Œä¾¿äºè°ƒè¯•ã€‚

### æ—¥å¿—æŸ¥çœ‹

åœ¨ GitHub Actions ä¸­æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š
1. è¿›å…¥ä»“åº“çš„ Actions é¡µé¢
2. ç‚¹å‡»å¯¹åº”çš„ workflow è¿è¡Œè®°å½•
3. æŸ¥çœ‹ "Run daily/weekly stats report" æ­¥éª¤çš„æ—¥å¿—

### æœ¬åœ°è°ƒè¯•

å¦‚æœæœ¬åœ°è¿è¡Œå‡ºç°é—®é¢˜ï¼Œå¯ä»¥æ·»åŠ è°ƒè¯•è¾“å‡ºï¼š
```bash
# å¯ç”¨è¯¦ç»†è¾“å‡º
python -u scripts/run_report.py daily 2>&1 | tee debug.log
```

## ğŸ“‹ é…ç½®ç¤ºä¾‹

### é‚®ä»¶é…ç½®ç¤ºä¾‹ï¼ˆGmailï¼‰

```bash
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password
EMAIL_RECIPIENT=admin@company.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
```

### OneBot é…ç½®ç¤ºä¾‹

```bash
ONEBOT_URL=http://localhost:5700/send_private_msg
ONEBOT_QQ=123456789
```

### ä»“åº“é…ç½®ç¤ºä¾‹

```json
[
  "microsoft/vscode",
  "facebook/react",
  "nodejs/node",
  "your-org/private-repo",
  "another-org/another-repo"
]
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä»“åº“é€‰æ‹©**: å»ºè®®é€‰æ‹©æ´»è·ƒåº¦é€‚ä¸­çš„ä»“åº“ï¼Œé¿å…é€‰æ‹©è¿‡äºæ´»è·ƒçš„ä»“åº“å¯¼è‡´ API é™æµ
2. **æ—¶é—´è®¾ç½®**: æ¯æ—¥æŠ¥å‘Šå»ºè®®åœ¨ UTC 0:00 è¿è¡Œï¼Œé¿å…è·¨æ—¶åŒºé—®é¢˜
3. **é€šçŸ¥é…ç½®**: å»ºè®®åŒæ—¶é…ç½®é‚®ä»¶å’Œ OneBotï¼Œç¡®ä¿é‡è¦ä¿¡æ¯ä¸é—æ¼
4. **æƒé™ç®¡ç†**: ä½¿ç”¨æœ€å°æƒé™åŸåˆ™ï¼ŒGITHUB_TOKEN åªéœ€è¦ `repo` æƒé™
5. **ç›‘æ§å‘Šè­¦**: å®šæœŸæ£€æŸ¥ GitHub Actions è¿è¡ŒçŠ¶æ€ï¼Œç¡®ä¿æŠ¥å‘Šæ­£å¸¸ç”Ÿæˆ

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### æ›´æ–°ä¾èµ–

```bash
pip install --upgrade -r requirements.txt
```

### ä¿®æ”¹é…ç½®

1. ä¿®æ”¹ `config/settings.json` è°ƒæ•´æŠ¥å‘Šè®¾ç½®
2. ä¿®æ”¹ `config/repos.json` æ›´æ–°ä»“åº“åˆ—è¡¨
3. åœ¨ GitHub Secrets ä¸­æ›´æ–°ç¯å¢ƒå˜é‡

### ç‰ˆæœ¬å‡çº§

1. æ‹‰å–æœ€æ–°ä»£ç ï¼š`git pull origin main`
2. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰å˜æ›´
3. æµ‹è¯•æ–°ç‰ˆæœ¬ï¼š`python scripts/run_report.py daily`

## æŠ€æœ¯æ ˆ

- **Python 3.10+**: ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **PyGithub**: GitHub API å®¢æˆ·ç«¯
- **requests**: HTTP è¯·æ±‚åº“
- **python-dotenv**: ç¯å¢ƒå˜é‡ç®¡ç†
- **GitHub Actions**: è‡ªåŠ¨åŒ–éƒ¨ç½²å¹³å°

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æŒ‡å—

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/your-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add some feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/your-feature`
5. åˆ›å»º Pull Request

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤) éƒ¨åˆ†
2. æœç´¢å·²æœ‰çš„ [Issues](https://github.com/your-username/github_bot/issues)
3. åˆ›å»ºæ–°çš„ Issue æè¿°é—®é¢˜
